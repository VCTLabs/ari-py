<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>About &mdash; ari-py 0.6.1.dev5 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ari" href="api/modules.html" />
    <link rel="prev" title="Welcome to the ari-py documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> ari-py
          </a>
              <div class="version">
                0.6.1.dev5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="#usage">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#api">API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#making-rest-calls">Making REST calls</a></li>
<li class="toctree-l2"><a class="reference internal" href="#registering-event-callbacks">Registering event callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#object-lifetime">Object lifetime</a></li>
<li class="toctree-l2"><a class="reference internal" href="#caveats">Caveats</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#development">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#todo">TODO</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">ari</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">0.2.3 (2017-08-28)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html#id2">0.2.1 (2016-06-09)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html#id3">0.2.0 (2016-04-20)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html#id4">0.1.3 (2014-09-08)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html#id5">0.1.2 (2014-08-12)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html#id6">0.1.1 (2013-10-28)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html#id7">0.1.0 (2013-10-28)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ari-py</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">About</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/README.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="about">
<h1>About<a class="headerlink" href="#about" title="Permalink to this heading"></a></h1>
<p>This package contains the Python client library for the Asterisk REST
Interface. It builds upon the
<a class="reference external" href="https://github.com/digium/swagger-py">Swagger.py</a> library, providing an
improved, Asterisk-specific API over the API generated by Swagger.py</p>
</section>
<section id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this heading"></a></h1>
<p>Install from source using the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo ./setup.py install
</pre></div>
</div>
<section id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this heading"></a></h2>
<p>An ARI client can be created simply by the <code class="docutils literal notranslate"><span class="pre">ari.connect</span></code> method. This will
create a client based on the Swagger API downloaded from Asterisk.</p>
<p>The API is modeled into the Repository Pattern, as you would find in Domain
Driven Design. Each Swagger Resource (a.k.a. API declaration) is mapped into a
Repository object, which is provided as a field on the client
(<code class="docutils literal notranslate"><span class="pre">client.channels</span></code>, <code class="docutils literal notranslate"><span class="pre">client.bridges</span></code>).</p>
<p>Responses from Asterisk are mapped into first-class objects, akin to Domain
Objects in the Repository Pattern. These are provided both on the responses
to RESTful API calls, and for fields from events received over the WebSocket.</p>
</section>
<section id="making-rest-calls">
<h2>Making REST calls<a class="headerlink" href="#making-rest-calls" title="Permalink to this heading"></a></h2>
<p>Each Repository Object provides methods which invoke the non-instance specific
operations of the associated Swagger resource (<code class="docutils literal notranslate"><span class="pre">bridges.list()</span></code>,
<code class="docutils literal notranslate"><span class="pre">channels.get()</span></code>). Instance specific methods are also provided, which require
identity parameters to be passed along (<code class="docutils literal notranslate"><span class="pre">channels.get(channelId=id)</span></code>).</p>
<p>Instance specific methods are also provided on the Domain Objects
(<code class="docutils literal notranslate"><span class="pre">some_channel.hangup()</span></code>).</p>
</section>
<section id="registering-event-callbacks">
<h2>Registering event callbacks<a class="headerlink" href="#registering-event-callbacks" title="Permalink to this heading"></a></h2>
<p>Asterisk may send asyncronous messages over a WebSocket to indicate events of
interest to the application.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Client</span></code> object has the following methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">on_event(event_type,</span> <span class="pre">callback,</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span></code>, which can be used to
subscribe for specific events from Asterisk</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">on_application_registered(application_name,</span> <span class="pre">callback,</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span></code>,
which can be used to run code right after the application is registered to
Asterisk.</p></li>
</ul>
<p>The first-class objects also have ‘on_event’ methods, which can subscribe to
Stasis events relating to that object.</p>
</section>
<section id="object-lifetime">
<h2>Object lifetime<a class="headerlink" href="#object-lifetime" title="Permalink to this heading"></a></h2>
<p>The Repository Objects exist for the lifetime of the client that owns them.</p>
<p>Domain Objects are ephemeral, and not tied to the lifetime of the underlying
object in Asterisk. Pratically, this means that if you call
<code class="docutils literal notranslate"><span class="pre">channels.get('1234')</span></code> several times, you may get a different object back
every time.</p>
<p>You may hold onto an instance of a Domain Object, but you should consider it
to be stale. The data contained in the object may be out of date, but the
methods on the object should still behave properly.</p>
<p>If you invoke a method on a stale Domain Object that no longer exists in
Asterisk, you will get a HTTPError exception (404 Not Found).</p>
</section>
<section id="caveats">
<h2>Caveats<a class="headerlink" href="#caveats" title="Permalink to this heading"></a></h2>
<p>The dynamic methods exposed by Repository and Domain objects are, effectively,
remote procedure calls. The current implementation is synchronous, which means
that if anything were to happen to slow responses (slow network, packet loss,
system load, etc.), then the entire application could be affected.</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ari</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">ari</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;http://localhost:8088/&#39;</span><span class="p">,</span> <span class="s1">&#39;hey&#39;</span><span class="p">,</span> <span class="s1">&#39;peekaboo&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">on_dtmf</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="n">digit</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;digit&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">digit</span> <span class="o">==</span> <span class="s1">&#39;#&#39;</span><span class="p">:</span>
        <span class="n">channel</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">media</span><span class="o">=</span><span class="s1">&#39;sound:goodbye&#39;</span><span class="p">)</span>
        <span class="n">channel</span><span class="o">.</span><span class="n">continueInDialplan</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">digit</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span>
        <span class="n">channel</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">media</span><span class="o">=</span><span class="s1">&#39;sound:asterisk-friend&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">channel</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">media</span><span class="o">=</span><span class="s1">&#39;sound:digits/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">digit</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_start</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="n">channel</span><span class="o">.</span><span class="n">on_event</span><span class="p">(</span><span class="s1">&#39;ChannelDtmfReceived&#39;</span><span class="p">,</span> <span class="n">on_dtmf</span><span class="p">)</span>
    <span class="n">channel</span><span class="o">.</span><span class="n">answer</span><span class="p">()</span>
    <span class="n">channel</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">media</span><span class="o">=</span><span class="s1">&#39;sound:hello-world&#39;</span><span class="p">)</span>


<span class="n">client</span><span class="o">.</span><span class="n">on_channel_event</span><span class="p">(</span><span class="s1">&#39;StasisStart&#39;</span><span class="p">,</span> <span class="n">on_start</span><span class="p">)</span>
<span class="n">client</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">apps</span><span class="o">=</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="development">
<h1>Development<a class="headerlink" href="#development" title="Permalink to this heading"></a></h1>
<p>The code is documented using <a class="reference external" href="http://sphinx-doc.org/">Sphinx</a>, which
allows <a class="reference external" href="http://confluence.jetbrains.net/display/PYH/">IntelliJ IDEA</a>
to do a better job at inferring types for autocompletion.</p>
<p>To keep things isolated, I also recommend installing (and using)
<a class="reference external" href="http://www.virtualenv.org/">virtualenv</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo pip install virtualenv
$ mkdir -p ~/virtualenv
$ virtualenv ~/virtualenv/ari
$ . ~/virtualenv/ari/bin/activate
</pre></div>
</div>
<p><a class="reference external" href="http://pypi.python.org/pypi/setuptools">Setuptools</a> is used for
building. <a class="reference external" href="http://nose.readthedocs.org/en/latest/">Nose</a> is used
for unit testing, with the <a class="reference external" href="http://nedbatchelder.com/code/coverage/">coverage</a> plugin installed to
generated code coverage reports. Pass <code class="docutils literal notranslate"><span class="pre">--with-coverage</span></code> to generate
the code coverage report. HTML versions of the reports are put in
<code class="docutils literal notranslate"><span class="pre">cover/index.html</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./setup.py develop   # prep for development (install deps, launchers, etc.)
$ ./setup.py nosetests # run unit tests
$ ./setup.py bdist_egg # build distributable
</pre></div>
</div>
<section id="todo">
<h2>TODO<a class="headerlink" href="#todo" title="Permalink to this heading"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p>Create asynchronous bindings that can be used with Twisted, Tornado, etc.</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="license">
<h1>License<a class="headerlink" href="#license" title="Permalink to this heading"></a></h1>
<p>Copyright (c) 2013-2014, Digium, Inc. All rights reserved.</p>
<p>Swagger.py is licensed with a <a class="reference external" href="http://opensource.org/licenses/BSD-3-Clause">BSD 3-Clause
License</a>.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to the ari-py documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api/modules.html" class="btn btn-neutral float-right" title="ari" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>